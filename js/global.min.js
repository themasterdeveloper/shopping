function GetParameterValues(e){for(var t=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),s=0;s<t.length;s++){var n=t[s].split("=");if(n[0]==e)return n[1]}}function toggleFullScreen(){document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement?document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen():document.documentElement.requestFullscreen?document.documentElement.requestFullscreen():document.documentElement.msRequestFullscreen?document.documentElement.msRequestFullscreen():document.documentElement.mozRequestFullScreen?document.documentElement.mozRequestFullScreen():document.documentElement.webkitRequestFullscreen&&document.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)}window.onerror=function(e,t,s){console.log("JavaScript error: "+e+" on line "+s+" for "+t)};var d="d="+(new Date).toJSON(),webservice_path="/ws/br.php",cur_page=0,page_size=5,total_rows=0,msg,type,search,record_id,save_login_name=!1,error=!1;setCookie=function(e,t,s){var n=new Date;n.setDate(n.getDate()+s);var a=escape(t)+(null==s?"":";path=/;expires="+n.toUTCString());document.cookie=e+"="+a},getCookie=function(e){var t=document.cookie,s=t.indexOf(" "+e+"=");if(-1==s&&(s=t.indexOf(e+"=")),-1==s)t=null;else{s=t.indexOf("=",s)+1;var n=t.indexOf(";",s);-1==n&&(n=t.length),t=unescape(t.substring(s,n))}return t},deleteAllCookies=function(){for(var e=document.cookie.split(";"),t=0;t<e.length;t++){var s=e[t],n=s.indexOf("="),a=n>-1?s.substr(0,n):s;document.cookie=a+"=;path=/;expires=Thu, 01 Jan 1970 00:00:00 GMT"}},showMsg=function(e){$(".alert").removeClass("alert-warning").addClass("alert-info"),$(".alert #msg").html(e),$(".alert").show()},showErr=function(e){$(".alert").removeClass("alert-info").addClass("alert-warning"),$(".alert #msg").html(e),$(".alert").show()},pad=function(e,t){for(e=String(e),t=t||2;e.length<t;)e="0"+e;return e},$(function(){var e=navigator.userAgent;e.indexOf("Mozilla/5.0")>-1&&e.indexOf("Android ")>-1&&e.indexOf("AppleWebKit")>-1&&-1===e.indexOf("Chrome")&&$("select.form-control").removeClass("form-control").css("width","100%")}),jQuery.fn.center=function(){return this.css("position","absolute"),this.css("top",Math.max(0,($(window).height()-$(this).outerHeight())/3+$(window).scrollTop())+"px"),this.css("left",Math.max(0,($(window).width()-$(this).outerWidth())/2+$(window).scrollLeft())+"px"),this},$.fn.serializeObject=function(){var e={},t=this.serializeArray();return $.each(t,function(){void 0!==e[this.name]?(e[this.name].push||(e[this.name]=[e[this.name]]),e[this.name].push(this.value||"")):e[this.name]=this.value||""}),e},String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")},String.prototype.ltrim=function(){return this.replace(/^\s+/,"")},String.prototype.rtrim=function(){return this.replace(/\s+$/,"")},String.prototype.fulltrim=function(){return this.replace(/(?:(?:^|\n)\s+|\s+(?:$|\n))/g,"").replace(/\s+/g," ")},String.prototype.left=function(e){return this.substring(0,e)},String.prototype.right=function(e){var t=this.length;return this.substring(t,t-e)},$.ajaxSetup({type:"GET",url:webservice_path,contentType:"application/json; charset=utf-8",dataType:"json",cache:!0,async:!0,timeout:0,error:function(e,t){log_ajax_error(e,t)}}),$(document).ajaxStart(function(){$(".fa").show().center(),console.log("ajaxStart")}),$(document).ajaxSend(function(){$(".fa").show().center(),console.log("ajaxSend")}),$(document).ajaxStop(function(){console.log("ajaxStop"),$(".fa").fadeOut("slow")}),$(document).ajaxError(function(){console.log("ajaxError"),setTimeout(function(){$(".fa").fadeOut("slow")},3e3)}),log_ajax_error=function(e,t){console.log(e.responseText),showErr("An error occurred! ["+e.responseText+"] "+(t||e.status))},validate_form=function(e){$(".alert").hide();var t=e.length,s="";error=!1;for(var n=0;n<t;n++)""!=(s=e[n].name)&&validate_field(s);error?showErr("Some errors were found. Please correct them and try again"):save_ticket()},validate_field=function(e){var t="#"+e,s="#"+e+"1";""==$(t).val()?($(t).closest(".form-group").removeClass("has-success has-feedback").addClass("has-error has-feedback"),$(s).removeClass("glyphicon-ok").addClass("glyphicon-remove"),error=!0):($(t).closest(".form-group").removeClass("has-error has-feedback").addClass("has-success has-feedback"),$(s).removeClass("glyphicon-remove").addClass("glyphicon-ok"))},save_ticket=function(){var e=$("#settings-form").serializeObject();e.action="save_ticket",JSON.stringify(e).indexOf("notify")<0&&(e.notify=""),$.ajax({data:e,success:function(e){$(".home-text").show(),$(".ticket-form").hide(),showMsg("Ticket successfuly launched")}})},load_tickets=function(){var e={};user_id=0,e.action="tickets_list",e.search=$("#search_text").val(),e.page=cur_page,e.page_size=page_size,$(".alert").hide(),console.log(JSON.stringify(e)),$(".is_disabled").removeClass("disabled"),$(".is_disabled").addClass("disabled"),$.ajax({data:e,success:function(e){if(null==e)return $("#dashboard-table tbody").empty(),!1;var t=e.length;total_rows=e[0].total_rows,$(".badge").html(total_rows);var s=parseInt(total_rows)/parseInt(page_size);s=Math.ceil(s);var n={prevPage:null,nextPage:null,curPage:null,pageSize:null,totalRows:null,generate:function(){var e=parseInt(this.curPage)/this.pageSize+1;return n="<tr><td><table class='table'><tr>",n+="<td width='33%'><div class='pull-left'>",this.prevPage>-1?n+="<button class='btn btn-primary' onclick='go_page("+this.prevPage.toString()+")'>Previous</button>":n+="&nbsp;",n+="</div></td>",n+="<td width='33%' align='center'>Page "+e+" or "+s+"</td>",n+="<td width='33%'><div class='pull-right'>",parseInt(this.nextPage)<parseInt(this.totalRows)?n+="<button class='btn btn-primary' onclick='go_page("+this.nextPage.toString()+")'>Next</button>":n+="&nbsp;",n+="</div></td>",n+="</tr></table></td></tr>"}},a=parseInt(cur_page)-page_size,o=parseInt(cur_page)+page_size;n.prevPage=a,n.nextPage=o,n.curPage=cur_page,n.pageSize=page_size,n.totalRows=total_rows;var n=n.generate(),i=[],l=0;for(i[l]="<tr><td colspan=20>",i[l]++,r=0;r<t;r++){$this=e[r],i[l]="<div class='list-group'>",l++;var c="",u="";switch($this.priority_id){case"1":c="btn btn-danger btn-sm";break;case"2":c="btn btn-warning btn-sm";break;case"3":c="btn btn-info btn-sm";break;case"4":c="btn btn-default btn-sm"}switch($this.status_id){case"0":u="btn btn-default btn-sm";break;case"1":u="btn btn-primary btn-sm";break;case"2":u="btn btn-active btn-sm"}for(var d in $this)-1=="-priority_id-type_id-status_id-total_rows-".indexOf("-"+d+"-")&&(i[l]="<a href='#' class='list-group-item'>",i[l]+="<h4 class='list-group-item-heading'>",i[l]+="<button class='btn btn-primary'>"+$this.id+"</button>",i[l]+="<span class='app'>"+$this.app+"</span>",i[l]+="<span class='title'>"+$this.title+"</span>",i[l]+="<small><span class='type btn btn-default pull-right'>"+$this.type+"</span></small>",i[l]+="</h4>",i[l]+="<p class='list-group-item-text'>",i[l]+="<span class='comment'>"+$this.comment+"</span>",i[l]+="</p>",i[l]+="<p class='list-group-item-text'>",i[l]+="<small><span class='email_address'>"+$this.email_address+"</span>",i[l]+="<span class='created'>"+$this.created+"</span></small>",i[l]+="<button onclick=change_priority("+$this.id+") class='"+c+" pull-right'>"+$this.priority+"</button>",i[l]+="<button onclick=change_status("+$this.id+") class='"+u+"'>"+$this.status+"</button>",i[l]+="</p>",i[l]+="</a>");i[l]+="</div>",l++}i[l]="</td></tr>",$("#dashboard-table tbody").empty().append(i.join("")).show(),$("#dashboard-table thead").empty().append(n),$("#dashboard-table tfoot").empty().append(n),$(".is_disabled").addClass("disabled"),$('input[name="selected_row"]').on("change",function(){record_id=this.value,$(".is_disabled").removeClass("disabled")}),$(".ticket-form").hide(),$(".table-responsive").show(),$(".search-box").show()}})},go_page=function(e){return parseInt(e)<0?(showMsg("this is the first page"),!1):parseInt(e)>=total_rows?(showMsg("this is the last page"),!1):(cur_page=e,void load_tickets())},change_priority=function(e){event.preventDefault();var t={};t.action="change_priority",t.ticket_id=e,console.log(JSON.stringify(t)),$.ajax({data:t,success:function(t){refresh_changes(e)}})},change_status=function(e){event.preventDefault();var t={};t.action="change_status",t.ticket_id=e,$.ajax({data:t,success:function(t){refresh_changes(e)}})},change_responsible=function(e){event.preventDefault();var t={};t.action="change_responsible",t.ticket_id=e,$.ajax({data:t,success:function(t){refresh_changes(e)}})},refresh_changes=function(e){var t={};t.action="get_title",t.ticket_id=e,console.log(JSON.stringify(t)),$.ajax({data:t,success:function(e){$this=e[0],$("#search_text").val($this.title),load_tickets()}})};