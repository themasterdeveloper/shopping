function GetParameterValues(e){for(var t=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),o=0;o<t.length;o++){var a=t[o].split("=");if(a[0]==e)return a[1]}}function toggleFullScreen(){document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement?document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen():document.documentElement.requestFullscreen?document.documentElement.requestFullscreen():document.documentElement.msRequestFullscreen?document.documentElement.msRequestFullscreen():document.documentElement.mozRequestFullScreen?document.documentElement.mozRequestFullScreen():document.documentElement.webkitRequestFullscreen&&document.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)}function listCookies(){for(var e=document.cookie.split(";"),t={},o=0;o<e.length;o++){var a=e[o].split("="),s=a[0].replace(/^ /,""),n=a[1];void 0!==t[s]?(t[s].push||(t[s]=[t[s]]),t[s].push(n||"")):t[s]=n||""}return t}window.onerror=function(e,t,o){log("JavaScript error: "+e+" on line "+o+" for "+t)};var d="d="+(new Date).toJSON(),webservice_path="/ws/br.php",record_id,token="",error=!1,intro=!1,HOME="/home.html",sms_url="https://www.bulksmsnigeria.net/components/com_spc/smsapi.php",sms_user="nwabuezestephen27@gmail.com",sms_password="Foot27ball",sms_sender="iyabasira",log=function(e,t){"True"==getCookie("Debug")&&console.debug(e,t)};setCookie=function(e,t,o){var a=new Date;a.setDate(a.getDate()+o);var s=escape(t)+(null==o?"":";path=/;expires="+a.toUTCString());document.cookie=e+"="+s},getCookie=function(e){var t=document.cookie,o=t.indexOf(" "+e+"=");if(-1==o&&(o=t.indexOf(e+"=")),-1==o)t=null;else{o=t.indexOf("=",o)+1;var a=t.indexOf(";",o);-1==a&&(a=t.length),t=unescape(t.substring(o,a))}return t},deleteAllCookies=function(){for(var e=document.cookie.split(";"),t=0;t<e.length;t++){var o=e[t],a=o.indexOf("="),s=a>-1?o.substr(0,a):o;document.cookie=s+"=;path=/;expires=Thu, 01 Jan 1970 00:00:00 GMT"}},showMsg=function(e){$(".alert").removeClass("alert-danger").removeClass("alert-info").addClass("alert-info"),$(".alert #msg").html(e),$(".alert").show()},showErr=function(e){$(".alert").removeClass("alert-info").removeClass("alert-danger").addClass("alert-danger"),$(".alert #msg").html(e),$(".alert").show()},pad=function(e,t){for(e=String(e),t=t||2;e.length<t;)e="0"+e;return e},jQuery.fn.center=function(){return this.css("position","absolute"),this.css("top",Math.max(0,($(window).height()-$(this).outerHeight())/3+$(window).scrollTop())+"px"),this.css("left",Math.max(0,($(window).width()-$(this).outerWidth())/2+$(window).scrollLeft())+"px"),this},$.fn.serializeObject=function(){var e={},t=this.serializeArray();return $.each(t,function(){void 0!==e[this.name]?(e[this.name].push||(e[this.name]=[e[this.name]]),e[this.name].push(this.value||"")):e[this.name]=this.value||""}),e},$.ajaxSetup({type:"GET",url:webservice_path,contentType:"application/json; charset=utf-8",dataType:"json",cache:!0,async:!0,timeout:0,error:function(e,t){log_ajax_error(e,t)}}),$(document).ajaxStart(function(){$(".fa").show().center()}),$(document).ajaxStop(function(){$(".fa").fadeOut("slow")}),$(document).ajaxError(function(){setTimeout(function(){$(".fa").fadeOut("slow")},3e3)}),log_ajax_error=function(e,t){log(e),showErr("We are sorry, but there was an error accessing the database")},validate_form=function(e){$(".alert").hide();var t=e.length,o="";error=!1;for(var a=0;a<t;a++)""!=(o=e[a].name)&&validate_field(o);error?showErr("Some errors were found. Please correct them and try again"):save_ticket()},validate_field=function(e){var t="#"+e,o="#"+e+"1";""==$(t).val()?($(t).closest(".form-group").removeClass("has-success has-feedback").addClass("has-error has-feedback"),$(o).removeClass("glyphicon-ok").addClass("glyphicon-remove"),error=!0):($(t).closest(".form-group").removeClass("has-error has-feedback").addClass("has-success has-feedback"),$(o).removeClass("glyphicon-remove").addClass("glyphicon-ok"))},load_products=function(){0==token.length&&get_token(),$(".area-message").addClass("hidden");var e={};e.action="products_list",e.search=$("#search_text").val(),e.token=getCookie("token"),e.area_id=getCookie("chosen-area"),log("load_products",e),$(".alert").hide(),$.ajax({data:e,success:function(e){if(log("load_products",e),1==e[0].error)return $("#dashboard-table").empty(),showErr(e[0].message),!1;var t=e.length,o=[],a=0;for(r=0;r<t;r++){$this=e[r],o[a]="<div class='list-group'>",a++;for(var s in $this)-1=="-total_rows-".indexOf("-"+s+"-")&&(o[a]="<div href='#' class='list-group-item it-"+$this.id+"'>",o[a]+="<img src='/img/"+$this.logo+"' class='shop-logo'>",o[a]+="<span class='area'>"+$this.area+"</span>",o[a]+="<span class='product'>"+$this.product+"</span><br/>",o[a]+="<img class='product-image' src='/img/"+$this.image+"'>",o[a]+="<span class='price'>"+$this.price+"</span>",o[a]+="<button class='buy-product-button btn btn-success btn-lg' onclick=buy_product("+$this.id+") >ORDER NOW</button>",o[a]+="</div>");o[a]+="</div>",a++}$("#dashboard-table").empty().append(o.join("")).show(),$(".table-responsive").show(),$(".search-box").show(),navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(e){var t={lat:e.coords.latitude,lng:e.coords.longitude};save_location(t)})}}),updateBasket(),log("listCookies",listCookies())},get_token=function(){if(getCookie("token"))return token=getCookie("token"),void $("#token").val(token);var e={};e.action="get_token",e.area_id=getCookie("chosen-area"),log("get_token",e),$.ajax({data:e,success:function(e){log("get_token",e),token=e[0].token,$("#token").val(token),setCookie("token",token)}})},buy_product=function(e){var t="it-"+e,o=$("."+t).position();$("#quantity").val(1),$(".order-form").css("top",o.top+32).show(),$(".order-form #product_id").val(e),$(".shadow").show(),event.preventDefault()},add_product=function(){var e={};e.action="save_item",e.token=token,e.product_id=$("#product_id").val(),e.quantity=$("#quantity").val(),log("add_product",e),$.ajax({data:e,success:function(e){log("add_product",e);var t=e[0];0==t.error?($(".order-form").hide(),$(".shadow").hide()):(2==t.error&&resetToken(),$(".error_message").html(t.message).show()),updateBasket(),load_products()}})},updateBasket=function(){var e={};e.action="get_total_basket",e.token=getCookie("token"),log("updateBasket",e),$.ajax({data:e,success:function(e){log("updateBasket",e);var t=e[0],o=t.grand_total;$(".basket").html(o),setCookie("total_basket",t.total_basket),setCookie("total_fees",t.total_fees),setCookie("delivery_fees",t.delivery_fees),setCookie("grand_total",t.grand_total),parseFloat(o)>0?$(".basket").parent().removeClass("hidden"):$(".basket").parent().addClass("hidden")}})},load_basket_products=function(){var e={};user_id=0,e.action="basket_list",e.token=getCookie("token"),log("load_basket_products",e),updateBasket(),$.ajax({data:e,success:function(e){if(log("load_basket_products",e),1==e[0].error)return void $("#content").load(HOME);var t=[],o=[],a=0,s="-id-area-";o[a]="<tr>",$this=e[0];for(var n in $this)-1==s.indexOf("-"+n+"-")&&(o[a]="<th class='__"+n+"'>"+n+"</th>",a++);o[a]="</tr>",a=0;var i=e.length;for(r=0;r<i;r++){$this=e[r],t[a]="<tr>",a++;for(var n in $this)-1==s.indexOf("-"+n+"-")&&(t[a]="shop"==n?"<td class='__"+n+"'>"+$this[n]+"<br>"+$this.area+"</td>":"<td class='__"+n+"'>"+$this[n]+"</td>",a++);t[a]="<td><a href='#' onclick=removeItem("+$this.id+")><span class='glyphicon glyphicon-remove'></span></td></a></tr>",a++}$("#basket-table thead").empty().append(o.join("")),$("#basket-table tbody").empty().append(t.join("")),a=0,t.length=0,t[a]="<tr><td colspan=3  class='_amount _top_line'>TOTAL BASKET</td><td class='_amount _top_line'>"+getCookie("total_basket")+"</td><td  class='_top_line'></td></tr>",a++,t[a]="<tr><td colspan=3  class='_amount'>DELIVERY</td><td class='_amount'>"+getCookie("delivery_fees")+"</td><td></td></tr>",a++,t[a]="<tr><td colspan=3  class='_amount _grand_total'>TOTAL ORDER</td><td class='_amount  _grand_total'>"+getCookie("grand_total")+"</td><td class='_amount  _grand_total'></td></tr>",$("#basket-table tfoot").empty().append(t.join("")),$(".table-responsive").show()}})},removeItem=function(e){var t={};t.action="remove_item",t.item_id=e,log("removeItem",t),$.ajax({data:t,success:function(e){log("removeItem",e),load_basket_products()}})},removeAll=function(){var e={};e.action="remove_all",e.token=getCookie("token"),log("removeAll",e),$.ajax({data:e,success:function(e){log("removeAll",e),load_basket_products()}})},resetToken=function(){token="",$("#token").val(token),deleteAllCookies(),get_token()},get_areas=function(){var e={};e.action="get_areas",log("get_areas",e),$.ajax({data:e,success:function(e){log("get_areas",e),$(".areas-list").html(e[0].areas)}})},save_location=function(e){var t={};t.action="save_location",t.token=getCookie("token"),t.lat=e.lat,t.lng=e.lng,log("save_location",t),$.ajax({data:t,success:function(e){log("save_location",e)},error:function(e){log("save_location.error",e)}})},load_dropdown=function(e,t){t=void 0!==t&&t;var o={};o.action=e+"_list",log("load_"+e,o);var a="Nothing selected";switch(e){case"areas":a="Select an area"}$.ajax({data:o,success:function(o){log("load_"+e,o);var s=[],n=o.length;if(1==t)var i="<option></option>";for(r=0;r<n;r++)$this=o[r],s[r]=i+"<option value="+$this.id+">"+$this.value+"</option>",i="";$("."+e).empty().append(s.join("")).selectpicker({noneSelectedText:a}).selectpicker("refresh")}})};var submitForm=function(e){var t=e+"_save",o=e+"-form",a={};a.action=t,a.token=getCookie("token"),a.area_id=getCookie("chosen-area"),$("#"+o).find(":input:not(button):not(reset)").each(function(){var e=$(this);e.attr("id")&&(a[e.attr("id")]=e.val().trim())}),log("submitForm",a),$.ajax({data:a,success:function(e){log("submitForm",e),0!=e[0].error?showErr(e[0].message):(showMsg(e[0].message),setCookie("order_id",e[0].order_id),$("#content").load("/geolocation"))}})};notify=function(e){var t={};t.action="order_notify",t.order_id=e,log("notify",t),$.ajax({data:t,success:function(e){log("notify",e)}})},get_config_value=function(e){var t={};t.action="get_config_value",t.name=e,log("get_config_value",t),$.ajax({data:t,dataType:"json",success:function(t){log("get_config_value",t),setCookie(e,t[0].value)}})},save_area_location=function(e,t,o){var a={};a.action="save_area_location",a.area_id=e,a.lat=t,a.lng=o,log("save_area_location",a),$.ajax({data:a,dataType:"json",success:function(e){log("save_area_location",e),0!=e[0].error?showErr(e[0].message):showMsg(e[0].message)}})},save_shop_location=function(e,t,o,a){var s={};s.action="save_shop_location",s.area_id=e,s.shop_id=t,s.lat=o,s.lng=a,log("save_shop_location",s),$.ajax({data:s,dataType:"json",success:function(e){log("save_shop_location",e),0!=e[0].error?showErr(e[0].message):(showMsg(e[0].message),update_markers())}})},load_shops_locations=function(e){var t={};t.action="shops_locations_list",t.area_id=0,log("load_shops_locations",t),$.ajax({data:t,success:function(e){log("load_shops_locations",e),shops=e,setShopMarkers()}})},setShopMarkers=function(){for(var e=0;e<shops.length;e++){var t=shops[e],o=new google.maps.LatLng(t.lat,t.lng),a="<div><strong>"+t.shop+"</strong><br/>"+t.area+"</div>",s=new google.maps.Marker({position:o,map:map,title:t.name,icon:"/img/rsz_1fastfood-pin.png"}),n=new google.maps.InfoWindow({content:a});s.addListener("click",function(){n.open(map,s)}),markers.push(s)}};