"use strict";var delivery={data:{user_id:""},BUTTON:'<a href="javascript:void(0)" class="form-control btn btn-primary btn-lg btn-options" onclick="load_order({id})"><span class="glyphicon glyphicon-pencil"></span>{number}</a>',BUTTON2:'<a href="javascript:void(0)" class="btn btn-success btn-md shops" onclick="delivery.load_shop_data({id})">{name}</a>',TEMPLATE:'<div class="order-data-key">{key}:<div class="order-data-value"><strong>{value}</strong></div>',init:function(){$.ajaxSetup({url:delivery.url});cookies.setCookie("sender",4)},url:"/ws/delivery.php",deliverer_login:function(){var a={action:"deliverer_login"};$("#login").find(":input:not(button):not(reset)").each(function(){var b=$(this);if(b.attr("id")){a[b.attr("id")]=b.val().trim()}});common.log("deliverer_login",a);$.ajax({data:a,success:function(c){common.log("deliverer_login",c);if(c[0].user_id){document.getElementById("id01").style.display="none";var d=c[0];for(var b in d){cookies.setCookie(b,d[b])}delivery.data.user_id=d.user_id;cookies.setCookie("user_id",d.user_id);load("home.html")}else{common.showErr("Email or password incorrect")}}})},get_orders:function(){var a={action:"delivery_get_orders",deliverer_id:cookies.getCookie("user_id")};common.log("get_orders",a);$.ajax({data:a,success:function(c){common.log("get_orders",c);if(!c[0].error){for(var b=0;b<c.length;b++){var d=c[b];delivery.add_orders_buttons(d)}}else{$(".data").append("<div>No orders found</div>")}}})},add_orders_buttons:function(b){var a=delivery.BUTTON;a=a.replace("{id}",b.id);a=a.replace("{number}",b.number);$(".data").append(a)},get_order:function(){var a={action:"delivery_get_order",order_id:cookies.getCookie("order_id")};common.log("get_order",a);$.ajax({data:a,success:function(b){common.log("get_order",b);delivery.add_order_data(b[0]);cookies.setCookie("order_status",b[0].status)}})},get_address:function(){var a={action:"delivery_get_address",order_id:cookies.getCookie("order_id")};common.log("get_address",a);$.ajax({data:a,success:function(b){common.log("get_address",b);delivery.add_order_data(b[0])}})},get_shops:function(){var a={action:"delivery_get_shops",order_id:cookies.getCookie("order_id")};common.log("get_shops",a);$.ajax({data:a,success:function(c){common.log("get_shops",c);for(var b=0;b<c.length;b++){var d=c[b];delivery.add_shops(d)}}})},add_order_data:function(e){var d=[];var b=0;var c=delivery.TEMPLATE;for(var a in e){d[b]=c.replace("{key}",a).replace("{value}",e[a]);b++}$(".data").html(d.join(""))},add_shops:function(b){var a=delivery.BUTTON2;a=a.replace("{id}",b.id);a=a.replace("{name}",b.name);$(".data").append(a)},load_shop_data:function(a){$(".items tbody").empty();var b={action:"delivery_get_shop_items",order_id:cookies.getCookie("order_id"),shop_id:a};common.log("load_shop_data",b);$.ajax({data:b,success:function(g){common.log("load_shop_data",g);var e=[];var d=0;e[d]="<tr>";d++;for(var c in g[0]){e[d]="<th>"+c+"</th>";d++}e[d]="</tr>";$(".items thead").html(e.join(""));var f=0;for(var d=0;d<g.length;d++){var h=g[d];f+=parseFloat(g[d].total.replace(",",""));delivery.add_shop_items(h)}$(".items tfoot").html("<tr><td colspan=3></td><td>"+f.toFixed(2)+"</td></tr>");$(".table-responsive").show()}})},add_shop_items:function(d){var c=[];var b=0;c[b]="<tr>";b++;for(var a in d){c[b]="<td>"+d[a]+"</td>";b++}c[b]="</tr>";$(".items tbody").append(c.join(""))},order_picked:function(b){var a={action:"delivery_order_picked",order_id:cookies.getCookie("order_id")};common.log("delivery_order_picked",a);$.ajax({data:a,success:function(c){common.log("order_picked",c);$(".go-picked").addClass("hidden");load("order")}})},order_delivered:function(b){var a={action:"delivery_order_delivered",order_id:cookies.getCookie("order_id")};common.log("delivery_order_delivered",a);$.ajax({data:a,success:function(c){common.log("delivery_order_delivered",c);$(".go-delivered").addClass("hidden");load("orders")}})}};