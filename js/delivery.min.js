window.onerror=function(c,a,b){log("JavaScript error: "+c+" on line "+b+" for "+a)};var col_names=[];var d="d="+new Date().toJSON();var webservice_path="/ws/delivery.php",record_id,cur_page=0;error=false,$.ajaxSetup({type:"GET",url:webservice_path,contentType:"application/json; charset=utf-8",dataType:"json",cache:true,async:true,timeout:0,error:function(b,a){log_ajax_error(b,a)}});$(document).ajaxStart(function(){$(".fa").show().center()});$(document).ajaxStop(function(){$(".fa").fadeOut("slow")});$(document).ajaxError(function(){setTimeout(function(){$(".fa").fadeOut("slow")},3000)});log_ajax_error=function(b,a){log(b);showErr("We are sorry, but there was an error accessing the database")};var log=function(a,b){console.debug(a,b)};var setCookie=function(e,c,a){var f=new Date();f.setDate(f.getDate()+a);var b=escape(c)+((a==null)?"":";path=/;expires="+f.toUTCString());document.cookie=e+"="+b};var getCookie=function(c){var b=document.cookie;var e=b.indexOf(" "+c+"=");if(e==-1){e=b.indexOf(c+"=")}if(e==-1){b=null}else{e=b.indexOf("=",e)+1;var a=b.indexOf(";",e);if(a==-1){a=b.length}b=unescape(b.substring(e,a))}return b};var deleteAllCookies=function(){var e=document.cookie.split(";");for(var c=0;c<e.length;c++){var b=e[c];var f=b.indexOf("=");var a=f>-1?b.substr(0,f):b;document.cookie=a+"=;path=/;expires=Thu, 01 Jan 1970 00:00:00 GMT"}};jQuery.fn.center=function(){this.css("position","absolute");this.css("top",Math.max(0,(($(window).height()-$(this).outerHeight())/3)+$(window).scrollTop())+"px");this.css("left",Math.max(0,(($(window).width()-$(this).outerWidth())/2)+$(window).scrollLeft())+"px");return this};var showMsg=function(a){$(".alert").removeClass("alert-danger").removeClass("alert-info").addClass("alert-info");$(".alert #msg").html(a);$(".alert").show()};var showErr=function(a){$(".alert").removeClass("alert-info").removeClass("alert-danger").addClass("alert-danger");$(".alert #msg").html(a);$(".alert").show()};var deliverer_login=function(){var a={};a.action="deliverer_login";$("#login").find(":input:not(button):not(reset)").each(function(){var b=$(this);if(b.attr("id")){a[b.attr("id")]=b.val().trim()}});log("deliverer_login",a);$.ajax({data:a,success:function(b){log("deliverer_login",b);if(b[0].user_id){document.getElementById("id01").style.display="none";load("home.html");$this=b[0];for(key in $this){setCookie(key,$this[key])}}else{showErr("Email or password incorrect")}}})};var get_orders=function(){var a={};a.action="delivery_get_orders";a.deliverer_id=getCookie("user_id");log("get_orders",a);$.ajax({data:a,success:function(c){log("get_orders",c);for(var b=0;b<c.length;b++){$this=c[b];add_orders_buttons($this)}}})};var add_orders_buttons=function(b){var a='<a href="javascript:void(0)" class="form-control btn btn-primary btn-lg btn-options" onclick="load_order('+b.id+')">';a+='<span class="glyphicon glyphicon-pencil"></span>';a+=b.number;a+="</a>";$(".data").append(a)};var get_order=function(){var a={};a.action="delivery_get_order";a.order_id=getCookie("order_id");log("get_order",a);$.ajax({data:a,success:function(b){log("get_order",b);add_order_data(b[0])}})};var get_address=function(){var a={};a.action="delivery_get_address";a.order_id=getCookie("order_id");log("get_address",a);$.ajax({data:a,success:function(b){log("get_address",b);add_order_data(b[0])}})};var get_shops=function(){var a={};a.action="delivery_get_shops";a.order_id=getCookie("order_id");log("get_shops",a);$.ajax({data:a,success:function(c){log("get_shops",c);for(var b=0;b<c.length;b++){$this=c[b];add_shops($this)}}})};var add_order_data=function(e){var c=[];var a=0;var b='<div class="order-data-key">{key}:';b+='<div class="order-data-value"><strong>{value}</strong></div>';for(key in e){c[a]=b.replace("{key}",key).replace("{value}",e[key]);a++}$(".data").html(c.join(""))};var add_shops=function(b){var a='<a href="javascript:void(0)" class="btn btn-success btn-md shops" onclick="load_shop_data('+b.id+')">';a+=b.name;a+="</a>";$(".data").append(a)};var load_shop_data=function(a){$(".items tbody").empty();var b={};b.action="delivery_get_shop_items";b.order_id=getCookie("order_id");b.shop_id=a;log("load_shop_data",b);$.ajax({data:b,success:function(g){log("load_shop_data",g);var e=[];var c=0;e[c]="<tr>";c++;for(key in g[0]){e[c]="<th>"+key+"</th>";c++}e[c]="</tr>";$(".items thead").html(e.join(""));var f=0;for(var c=0;c<g.length;c++){$this=g[c];f+=parseFloat(g[c].total.replace(",",""));add_shop_items($this)}$(".items tfoot").html("<tr><td colspan=3></td><td>"+f.toFixed(2)+"</td></tr>");$(".table-responsive").show()}})};var add_shop_items=function(c){var b=[];var a=0;b[a]="<tr>";a++;for(key in c){b[a]="<td>"+c[key]+"</td>";a++}b[a]="</tr>";$(".items tbody").append(b.join(""))};