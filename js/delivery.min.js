var delivery={BUTTON:'<a href="javascript:void(0)" class="form-control btn btn-primary btn-lg btn-options" onclick="load_order({id})"><span class="glyphicon glyphicon-pencil"></span>{number}</a>',BUTTON2:'<a href="javascript:void(0)" class="btn btn-success btn-md shops" onclick="delivery.load_shop_data({id})">{name}</a>',TEMPLATE:'<div class="order-data-key">{key}:<div class="order-data-value"><strong>{value}</strong></div>',init:function(){$.ajaxSetup({url:delivery.url})},url:"/ws/delivery.php",deliverer_login:function(){var a={action:"deliverer_login"};$("#login").find(":input:not(button):not(reset)").each(function(){var b=$(this);if(b.attr("id")){a[b.attr("id")]=b.val().trim()}});log("deliverer_login",a);$.ajax({data:a,success:function(b){log("deliverer_login",b);if(b[0].user_id){document.getElementById("id01").style.display="none";load("home.html");$this=b[0];for(key in $this){cookies.setCookie(key,$this[key])}}else{showErr("Email or password incorrect")}}})},get_orders:function(){var a={action:"delivery_get_orders",deliverer_id:cookies.getCookie("user_id")};log("get_orders",a);$.ajax({data:a,success:function(c){log("get_orders",c);for(var b=0;b<c.length;b++){$this=c[b];delivery.add_orders_buttons($this)}}})},add_orders_buttons:function(b){var a=delivery.BUTTON;a=a.replace("{id}",b.id);a=a.replace("{number}",b.number);$(".data").append(a)},get_order:function(){var a={action:"delivery_get_order",order_id:cookies.getCookie("order_id")};log("get_order",a);$.ajax({data:a,success:function(b){log("get_order",b);delivery.add_order_data(b[0]);cookies.setCookie("order_status",b[0].status)}})},get_address:function(){var a={action:"delivery_get_address",order_id:cookies.getCookie("order_id")};log("get_address",a);$.ajax({data:a,success:function(b){log("get_address",b);delivery.add_order_data(b[0])}})},get_shops:function(){var a={action:"delivery_get_shops",order_id:cookies.getCookie("order_id")};log("get_shops",a);$.ajax({data:a,success:function(c){log("get_shops",c);for(var b=0;b<c.length;b++){$this=c[b];delivery.add_shops($this)}}})},add_order_data:function(d){var c=[];var a=0;var b=delivery.TEMPLATE;for(key in d){c[a]=b.replace("{key}",key).replace("{value}",d[key]);a++}$(".data").html(c.join(""))},add_shops:function(b){var a=delivery.BUTTON2;a=a.replace("{id}",b.id);a=a.replace("{name}",b.name);$(".data").append(a)},load_shop_data:function(a){$(".items tbody").empty();var b={action:"delivery_get_shop_items",order_id:cookies.getCookie("order_id"),shop_id:a};log("load_shop_data",b);$.ajax({data:b,success:function(f){log("load_shop_data",f);var d=[];var c=0;d[c]="<tr>";c++;for(key in f[0]){d[c]="<th>"+key+"</th>";c++}d[c]="</tr>";$(".items thead").html(d.join(""));var e=0;for(var c=0;c<f.length;c++){$this=f[c];e+=parseFloat(f[c].total.replace(",",""));delivery.add_shop_items($this)}$(".items tfoot").html("<tr><td colspan=3></td><td>"+e.toFixed(2)+"</td></tr>");$(".table-responsive").show()}})},add_shop_items:function(c){var b=[];var a=0;b[a]="<tr>";a++;for(key in c){b[a]="<td>"+c[key]+"</td>";a++}b[a]="</tr>";$(".items tbody").append(b.join(""))},order_picked:function(b){var a={action:"delivery_order_picked",order_id:cookies.getCookie("order_id")};log("delivery_order_picked",a);$.ajax({data:a,success:function(c){log("order_picked",c);$(".go-picked").addClass("hidden");load("order")}})},order_delivered:function(b){var a={action:"delivery_order_delivered",order_id:cookies.getCookie("order_id")};log("delivery_order_delivered",a);$.ajax({data:a,success:function(c){log("delivery_order_delivered",c);$(".go-delivered").addClass("hidden");load("orders")}})}};