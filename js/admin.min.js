var col_names=[];var d="d="+new Date().toJSON();var webservice_path="/ws/br.php",record_id,cur_page=0,error=false;var login=function(){var a={};a.action="login";$("#login").find(":input:not(button):not(reset)").each(function(){var b=$(this);if(b.attr("id")){a[b.attr("id")]=b.val().trim()}});common.log("login",a);$.ajax({data:a,success:function(c){common.log("login",c);if(c[0].user_id){document.getElementById("id01").style.display="none";$(".navbar").removeClass("hidden");var e=c[0];for(var b in e){if(e.hasOwnProperty(b)){cookies.setCookie(b,e[b])}}cookies.setCookie("login",1)}else{common.showErr("Email or password incorrect");cookies.setCookie("login",0)}}})};var saveData=function(a){var e=a+"_save";var b=a+"-form";var c={};c.action=e;$("#"+b).find(":input:not(button):not(reset)").each(function(){var f=$(this);if(f.attr("id")){c[f.attr("id")]=f.val().trim()}});common.log("saveData",c);$.ajax({data:c,success:function(f){common.log("saveData",f);if(f[0].error!==0){common.showErr(f[0].message)}else{common.showMsg(f[0].message);cookies.setCookie("record_id",f[0].record_id);$("."+a+"-list").removeClass("hidden");$("."+a+"-form").addClass("hidden");adm_load_table(a)}}})};var adm_delete_item=function(e,f){if(e===undefined){return false}record_id=e;var c="";var b=0;var a=col_names.length;$(".tr_"+e).find("td").each(function(){if(b<a){if($(this).html().length>0){c+="<div class='delete-data'>"+col_names[b]+": <span class='data'>"+$(this).html()+"</span></div>"}b++}});cookies.setCookie("item_id",e);cookies.setCookie("table",f);$("#confirm-body").html(c);$("#delete-confirmation").modal("show")};var commit_details_confirmed=function(){var a={};a.action="delete_table_record";a.table=cookies.getCookie("table");a.item_id=cookies.getCookie("item_id");common.log("get_table_data",a);$.ajax({data:a,success:function(b){common.log("adm_delete_item",b);if(b[0].error!==0){common.showErr(b[0].message)}else{$("#delete-confirmation").modal("hide");setTimeout(function(){adm_load_table(cookies.getCookie("table"))},1000)}}})};var adm_load_table=function(b,a){a=(typeof a==="undefined")?false:a;$(".table-name").html(b.replace("_"," / "));$(".alert").hide();if(cookies.getCookie("cur_page")){cur_page=parseInt(cookies.getCookie("cur_page"))}if(cookies.getCookie("rows_per_page")){rows_per_page=parseInt(cookies.getCookie("rows_per_page"))}var c={};c.action="adm_load_table_"+b;c.search=$("#search").val();c.limit=cur_page;c.rows=rows_per_page;common.log("load_table",c);$.ajax({data:c,success:function(g){common.log("load_table",g);if(g[0].error===1){$("#"+b+"-table tbody").empty();$("#"+b+"-table tbody").empty();$("#"+b+"-table tfood").empty();common.showErr(g[0].message);return false}var o="-id-active-status_name-total_records-";var f=g.length;var n=0;var h=[],j=0;var m=g[0];var t=m.total_records;h[j]="<tr>";j++;col_names.length=0;for(var s in m){if(o.indexOf("-"+s+"-")===-1){col_names[n]=s;h[j]="<th class='__"+s.replace(" ","_")+"'>"+s.replace("_"," ")+"</th>";j++;n++}}if(!a){h[j]="<th></th>";j++;n++}h[j]="</tr>";$("#"+b+"-table thead").empty().append(h.join(""));h=[];j=0;for(var e=0;e<f;e++){m=g[e];h[j]="<tr class='tr_"+m.id+"'>";j++;for(s in m){if(o.indexOf("-"+s+"-")===-1){switch(s){case"status":case"is_active":h[j]="<td class='__"+s.replace(" ","_")+"'><img class='__"+s.replace(" ","_")+"' src='"+m[s]+"'></td>";break;case"notify":h[j]="<td class='__"+s.replace(" ","_")+"'><img class='__"+s.replace(" ","_")+"' title='"+m.status_name+"' src='"+m[s]+"'></td>";break;case"image":h[j]="<td class='__"+s.replace(" ","_")+"'><img class='__"+s.replace(" ","_")+"' src='"+m[s]+"'></td>";break;default:h[j]="<td class='__"+s.replace(" ","_")+"'>"+m[s]+"</td>"}j++}}if(!a){h[j]='<td class="button-group">';j++;if(m.active===0){h[j]='<button class="btn btn-danger btn-sm delete-item" onclick="adm_delete_item('+m.id+",'"+b+"')\">Delete</button>";j++}h[j]='<button class="btn btn-primary btn-sm edit-item" onclick="adm_edit_item('+m.id+",'"+b+"')\">Edit</button>";j++;h[j]="</td>";j++}h[j]="</tr>";j++}$("#"+b+"-table tbody").empty().append(h.join(""));var q="";var p=parseInt(n);q+="<tr><td colspan="+p+">";if(cur_page>0){q+='<button class= "btn btn-success btn-md pull-left btn-prev table-button">Prev</button>'}else{q+='<button class= "btn btn-success btn-md pull-left disabled table-button">Prev</button>'}var k=parseInt(cur_page)+1;q+="Page "+k;if(cur_page<parseInt(t/rows_per_page)){q+='<button class= "btn btn-success btn-md pull-right btn-next">Next</button>'}else{q+='<button class= "btn btn-success btn-md pull-right disabled">Next</button>'}q+="<br/>"+t+" records";q+="</td></tr>";$("#"+b+"-table tfoot").empty().append(q);$(".btn-prev").on("click",function(i){i.preventDefault();cookies.setCookie("cur_page",cur_page-1);adm_load_table(b,a)});$(".btn-next").on("click",function(i){i.preventDefault();cookies.setCookie("cur_page",cur_page+1);adm_load_table(b,a)})}})};var adm_edit_item=function(a,b){$("#item_id").val(a);fillForm(a,b)};var remove_markers=function(){for(var a=0;a<markers.length;a++){markers[a].setMap(null)}};var close_infowindows=function(){for(var a=0;a<infowindows.length;a++){infowindows[a].close()}};var relocateMap=function(){if(navigator.geolocation){navigator.geolocation.getCurrentPosition(function(a){lat=a.coords.latitude;lng=a.coords.longitude;var b=new google.maps.LatLng(a.coords.latitude,a.coords.longitude);me_marker.setPosition(b)})}};var fillForm=function(a,b){var c={};c.action="get_table_record";c.table=b;c.item_id=a;common.log("get_table_record",c);$.ajax({data:c,success:function(f){common.log("get_table_record",f);var g=f[0];for(var e in g){if(g.hasOwnProperty(e)){if(e==="image"){if(g[e].length>0){$("#"+e).attr("src",g[e])}else{$("#"+e).attr("src","/img/no-image.jpg")}}else{$("#"+e).val(g[e])}common.log(e,g[e])}}if(b==="shop_product"){$(".selectpicker").prop("disabled",true);$("#availability").prop("disabled",false)}$(".selectpicker").selectpicker("refresh");$("."+b+"-list").addClass("hidden");$("."+b+"-form").removeClass("hidden")}})};var load_dropdown=function(a,e,b){e=(typeof e==="undefined")?false:e;b=(typeof b==="undefined")?false:b;var c={};c.action=a+"_list";common.log("load_"+a,c);var f="Nothing selected";switch(a){case"areas":f="Select an area";break;case"category":f="Select a category";break}$.ajax({data:c,success:function(k){common.log("load_"+a,k);var i=[];var g=k.length;var h="";if(e===1){h="<option></option>"}for(var j=0;j<g;j++){var m=k[j];i[j]=h+"<option value="+m.id+">"+m.value+"</option>";h=""}$("."+a).html(i.join("")).selectpicker({noneSelectedText:f}).selectpicker("refresh");if(b){$("."+a).prop("disabled",true);$("."+a).selectpicker("refresh")}}})};